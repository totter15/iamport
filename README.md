# 준비하기

[import docs](https://docs.iamport.kr/prepare)

[테스트 모드 설정](https://guide.iamport.kr/418a8dd5-6b84-419d-8d1b-ffd311b36404)

## 아임포트 홈페이지

1. 아임포트 회원가입
2. 관리자 콘솔 설정하기(테스트 모드로 설정)
3. 가맹점 정보 확인하기(가맹점 식별 코드 확인)

## 아임포트 JavaScript SDK로드

```javascript
<!-- jQuery -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
  <!-- iamport.payment.js -->
  <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-{SDK-최신버전}.js"></script>
```

# 일반결제 연동하기

1. 아임포트 라이브러기 추가
2. 결제 준비
   가명점 식별코드로 IMP객체 초기화
   ```javascript
       IMP.init(가맹점 식별 코드)
   ```
3. 결제 요청

```javascript
IMP.request_pay(params, callbackfn);
```

4. (서버)결제 정보 검증 및 저장
5. 결제 응답 처리

# 정기결제 연동하기

정기결제는 카드등록후 빌링키를 발급받아 원하는 정기결제 기능 구현 가능

- 즉시 정기 결제 : 즉기 결제 요청 > 결제 예약 / 반복 결제 구현
- 지연 정기 결제 : 결제 예약 / 반복 결제 구현
- 이용할 때마다 결제 : 결제 요청(매번 이용 후 혹은 원하는 시점에)

### **빌링키**

구독형 정기결제, 종량제 과금결제 등 원하는 시점에 재결제를 진행할 수 있는 결제용 암호화 키. 가맹점이 고객의 카드정보를 소유할 수 없기 때문에 카드사로부터 해당 카드에 대응하는 빌링키 발급 받아 저장하고, 원하는 시점에 해당 빌링키로 결제를 청구할 수 있다.

## 방법

### 1. REST API

    * 장점 : 가맹점이 원하는 형태의 화면으로 카드정보 입력란을 커스터마이징 가능
    * 단점 : 카드정보 전달과정의 보안프로세스를 구축, 개인정보 이용약관을 명시

### 2. 일반 결제창

    * 장점 : 카드정보가 서버 또는 아임포트의 서버를 거치지 않고 직접 PG사로 전달되기 때문에 통신구간 암호화등의 추가 보안 프로세스가 없다
    * 단점 : PG사의 일반결제창을 통해 카드정보를 입력받기 때문에 웹브라우저를 통해서만 빌링키 발급이 이루어지며, 카드정보 입력란을 커드터마이징 할 수 없다.

## REST API

1. 카드정보 입력받기
2. (서버)카드 정보 추출하기
3. (서버)발급 요청 및 응답 처리하기

## 일반결제창 활용하기

PG사별 결제창 방식으로 빌링키 발급받기
PG사에 따라 요구하는 param의 정책이 다르기 때문에 각 결제창 방식 가이드 확인

1. 발급 요청하기
2. 발급 응답 처리하기
3. (서버)결제 요청하기
4. (서버)결제 예약하기
5. (서버)반복 결제 구현하기
